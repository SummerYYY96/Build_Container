Bootstrap: docker
From: python:3.9

%post
    # Update and install dependencies
    apt-get update && apt-get install -y \
        gcc \
        g++ \
        make \
        libncurses5-dev \
        zlib1g-dev \
        libbz2-dev \
        liblzma-dev \
        libcurl4-openssl-dev \
        libssl-dev \
        samtools \
        bedtools \
        htslib 
        #pysam dependencies

    # Install CNVkit and its Python dependencies
    pip install numpy scipy pandas matplotlib reportlab biopython pyfaidx pysam pyvcf cnvkit==0.9.12
    
    # Install R and DNAcopy package, if necessary
    apt-get install -y r-base
    Rscript -e "install.packages('BiocManager', repos='https://cloud.r-project.org')" && \
    Rscript -e "BiocManager::install('DNAcopy', ask=FALSE)"

%test
    cnvkit.py version
